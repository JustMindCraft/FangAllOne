{"ast":null,"code":"import { LIST, UNKNOWN_METHOD, SHOW, CREATE, CREATE_MANY, UPDATE, UPDATE_MANY, DELETE, DELETE_MANY, DESTROY, DESTROY_MANY, AUTH, REGISTER, SHOW_ID, SHOW_UNIQUE, CHECK_AUTH, GET_SMS } from './constants/API';\nimport config from './config';\nimport axios from 'axios';\nvar token = window.localStorage.getItem('fang_token');\nexport function auth(method, condition) {\n  // console.log(method);\n  switch (method) {\n    case AUTH:\n      return axios.post(\"\".concat(config.basicUri, \"/auth?token=\").concat(token), condition);\n\n    case CHECK_AUTH:\n      return axios.get(\"\".concat(config.basicUri, \"/auth?token=\").concat(condition));\n\n    case REGISTER:\n      return axios.post(\"\".concat(config.basicUri, \"/register?token=\").concat(token), condition);\n\n    case GET_SMS:\n      return axios.post(\"\".concat(config.basicUri, \"/getsms?token=\").concat(token), condition);\n\n    default:\n      return new Promise(function (res, rej) {\n        return res(UNKNOWN_METHOD);\n      });\n  }\n}\nexport function api() {\n  var sourceName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"users\";\n  var method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : LIST;\n  var condition = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var optional = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var inflect = require('i')();\n\n  var singleSource = inflect.singularize(sourceName); //资源名单复数转换\n  // console.log(method);\n  // console.log(singleSource);\n  // console.log(sourceName);\n  // console.log(condition);\n  // console.log(config);\n  // console.log(optional);\n\n  switch (method) {\n    case LIST:\n      return axios.get(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        params: {\n          condition: condition,\n          optional: optional\n        }\n      });\n\n    case SHOW:\n      return axios.get(\"\".concat(config.basicUri, \"/\").concat(singleSource, \"?token=\").concat(token), {\n        params: {\n          condition: condition,\n          optional: optional\n        }\n      });\n\n    case SHOW_ID:\n      return axios.get(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"/\").concat(condition.id, \"?token=\").concat(token), {\n        params: {\n          optional: optional\n        }\n      });\n\n    case SHOW_UNIQUE:\n      return axios.get(\"\".concat(config.basicUri, \"/\").concat(singleSource, \"/\").concat(condition.key, \"?token=\").concat(token));\n\n    case CREATE:\n      return axios.post(\"\".concat(config.basicUri, \"/\").concat(singleSource, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case CREATE_MANY:\n      return axios.post(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case UPDATE:\n      return axios.patch(\"\".concat(config.basicUri, \"/\").concat(singleSource, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case UPDATE_MANY:\n      return axios.put(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case DELETE:\n      return axios.patch(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case DELETE_MANY:\n      return axios.put(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        condition: condition,\n        optional: optional\n      });\n\n    case DESTROY:\n      return axios.delete(\"\".concat(config.basicUri, \"/\").concat(singleSource, \"?token=\").concat(token), {\n        params: {\n          condition: condition,\n          optional: optional\n        }\n      });\n\n    case DESTROY_MANY:\n      return axios.delete(\"\".concat(config.basicUri, \"/\").concat(sourceName, \"?token=\").concat(token), {\n        params: {\n          condition: condition,\n          optional: optional\n        }\n      });\n\n    default:\n      return new Promise(function (res, rej) {\n        return res(UNKNOWN_METHOD);\n      });\n  }\n}","map":{"version":3,"sources":["/Users/zhoushixiong/zsx_work/FangAllOne/src/api.ts"],"names":["LIST","UNKNOWN_METHOD","SHOW","CREATE","CREATE_MANY","UPDATE","UPDATE_MANY","DELETE","DELETE_MANY","DESTROY","DESTROY_MANY","AUTH","REGISTER","SHOW_ID","SHOW_UNIQUE","CHECK_AUTH","GET_SMS","config","axios","token","window","localStorage","getItem","auth","method","condition","post","basicUri","get","Promise","res","rej","api","sourceName","optional","inflect","require","singleSource","singularize","params","id","key","patch","put","delete"],"mappings":"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","sourcesContent":["import { LIST,\n     UNKNOWN_METHOD,\n      SHOW, \n      CREATE, \n      CREATE_MANY, \n      UPDATE, UPDATE_MANY,\n       DELETE, DELETE_MANY, DESTROY, DESTROY_MANY, AUTH, REGISTER, SHOW_ID, SHOW_UNIQUE,\n        CHECK_AUTH, \n        GET_SMS} \nfrom './constants/API';\nimport config from './config';\nimport axios from 'axios';\n\n\nconst token = window.localStorage.getItem('fang_token');\n\nexport  function auth(method:string, condition:any){\n    // console.log(method);\n    \n    switch(method){\n        case AUTH:\n            return axios.post(`${config.basicUri}/auth?token=${token}`, \n                    condition,\n            );\n\n        case CHECK_AUTH:\n            return axios.get(`${config.basicUri}/auth?token=${condition}`);\n        \n        case REGISTER:\n            return axios.post(`${config.basicUri}/register?token=${token}`, \n                    condition,\n            );\n        case GET_SMS: \n            return axios.post(`${config.basicUri}/getsms?token=${token}`,\n                condition\n            );\n        default:\n            return new Promise((res: any, rej:any)=> res(UNKNOWN_METHOD));  \n    }\n}\n\n\nexport  function api(sourceName:string=\"users\", method:string=LIST, condition:any={}, optional:any={}){\n    const inflect = require('i')();\n    const singleSource = inflect.singularize(sourceName); //资源名单复数转换\n\n    // console.log(method);\n    // console.log(singleSource);\n    // console.log(sourceName);\n    // console.log(condition);\n    // console.log(config);\n    // console.log(optional);\n\n    switch (method) {\n        case LIST:\n            return axios.get(`${config.basicUri}/${sourceName}?token=${token}`, {\n                    params: {\n                        condition,\n                        optional,\n                    }\n            });\n        case SHOW:\n            return axios.get(`${config.basicUri}/${singleSource}?token=${token}`, {\n                    params: {\n                        condition,\n                         optional,\n                    }\n\n            });\n        case SHOW_ID:\n            return axios.get(`${config.basicUri}/${sourceName}/${condition.id}?token=${token}`,{\n                    params: {\n                        optional\n                    },\n            });\n\n        case SHOW_UNIQUE:\n\n            return axios.get(`${config.basicUri}/${singleSource}/${condition.key}?token=${token}`);\n\n        case CREATE:\n            return axios.post(`${config.basicUri}/${singleSource}?token=${token}`, {\n                    condition,\n                    optional,\n\n            });\n\n        case CREATE_MANY:\n            return axios.post(`${config.basicUri}/${sourceName}?token=${token}`, {\n                    condition,\n                    optional,\n            });\n        case UPDATE:\n           \n            return axios.patch(`${config.basicUri}/${singleSource}?token=${token}`, {\n                    condition,\n                    optional,\n            });\n        case UPDATE_MANY:\n            return axios.put(`${config.basicUri}/${sourceName}?token=${token}`, {\n                    condition,\n                    optional,\n\n            });\n        case DELETE:\n            return axios.patch(`${config.basicUri}/${sourceName}?token=${token}`, {\n                    condition,\n                    optional,\n            });\n        case DELETE_MANY:\n            return axios.put(`${config.basicUri}/${sourceName}?token=${token}`, {\n                    condition,\n                    optional,\n            });\n        case DESTROY:\n            return axios.delete(`${config.basicUri}/${singleSource}?token=${token}`, {\n                params: {\n                    condition,\n                    optional,\n                }\n            });\n        case DESTROY_MANY:\n            return axios.delete(`${config.basicUri}/${sourceName}?token=${token}`, {\n\n                params: {\n                    condition,\n                    optional,\n                }\n                    \n            });\n    \n        default:\n            return new Promise((res: any, rej:any)=> res(UNKNOWN_METHOD));\n    }\n\n}"]},"metadata":{},"sourceType":"module"}